<div class="hotel-results-page">
	<app-header></app-header>

	<!-- Search Bar (Sticky) - Landing Page Style -->
	<div class="sticky-search-bar">
		<div class="search-bar-inner">
			<div class="search-field">
				<label>Where to?</label>
				<div class="input-wrapper">
					<i class="fas fa-map-marker-alt"></i>
					<input type="text" class="search-input" [(ngModel)]="searchParams.location" placeholder="Enter destination" />
				</div>
			</div>
			<div class="search-field">
				<label>Dates</label>
				<div class="input-wrapper">
					<i class="fas fa-calendar"></i>
					<input type="date" class="search-input date-input" [(ngModel)]="searchParams.checkIn" />
					<span class="date-separator">-</span>
					<input type="date" class="search-input date-input" [(ngModel)]="searchParams.checkOut" />
				</div>
			</div>
			<div class="search-field travellers-field" (click)="toggleTravellersPopup()">
				<label>Travellers</label>
				<div class="input-wrapper">
					<i class="fas fa-user"></i>
					<span class="travellers-text">{{ getTravellersText() }}</span>
					<i class="fas fa-chevron-down"></i>
				</div>
			</div>
			<button class="search-btn" (click)="searchHotels()">
				<i class="fas fa-search"></i>
				Search
			</button>
		</div>
	</div>

	<!-- Navigation Tabs -->
	<div class="nav-tabs">
		<div class="tabs-container">
			<button class="tab" [class.active]="activeTab === 'all'" (click)="setActiveTab('all')">
				All stays
			</button>
			<button class="tab" [class.active]="activeTab === 'hotels'" (click)="setActiveTab('hotels')">
				Hotels
			</button>
			<button class="tab" [class.active]="activeTab === 'homes'" (click)="setActiveTab('homes')">
				Homes
			</button>
			<div class="sort-section">
				<a href="#" class="sort-link">How our sort order works <i class="fas fa-info-circle"></i></a>
				<select class="sort-select" [(ngModel)]="sortBy">
					<option value="recommended">Sort by recommended</option>
					<option value="price-low">Price: Low to High</option>
					<option value="price-high">Price: High to Low</option>
					<option value="rating">Rating: High to Low</option>
				</select>
			</div>
		</div>
	</div>

	<!-- Promotional Banner -->
	<div class="promo-banner">
		<div class="banner-content">
			<span>You'll always get our best prices when you're signed in</span>
			<button class="signin-btn">Sign in</button>
		</div>
	</div>

	<!-- Main Content -->
	<div class="results-container">
		<!-- Left Sidebar - Filters -->
		<aside class="filters-sidebar">
			<div class="map-section">
				<div class="mini-map">
					<!-- Map placeholder -->
					<div class="map-placeholder">
						<i class="fas fa-map"></i>
						<p>Map View</p>
					</div>
				</div>
				<a href="#" class="map-link">View in a map</a>
			</div>

			<div class="filter-section">
				<div class="filter-header">
					<h3>Compare properties</h3>
					<label class="toggle-switch">
						<input type="checkbox" [(ngModel)]="compareMode" />
						<span class="slider"></span>
					</label>
				</div>
				<p class="filter-desc">Get a side-by-side view of up to 5 properties.</p>
			</div>

			<div class="filter-section">
				<h3>Search by property name</h3>
				<div class="search-input-wrapper">
					<i class="fas fa-search"></i>
					<input type="text" placeholder="e.g. Marriott" class="filter-search" />
				</div>
			</div>

			<div class="filter-section">
				<h3>Filter by</h3>
				<div class="popular-filters">
					<label class="filter-checkbox">
						<input type="checkbox" [(ngModel)]="filters.hitecCity" />
						<span>HITEC City</span>
					</label>
					<label class="filter-checkbox">
						<input type="checkbox" [(ngModel)]="filters.breakfast" />
						<span>Breakfast included</span>
					</label>
					<label class="filter-checkbox">
						<input type="checkbox" [(ngModel)]="filters.freeCancellation" />
						<span>Free cancellation</span>
					</label>
					<label class="filter-checkbox">
						<input type="checkbox" [(ngModel)]="filters.pool" />
						<span>Pool</span>
					</label>
					<label class="filter-checkbox">
						<input type="checkbox" [(ngModel)]="filters.wifi" />
						<span>Free WiFi</span>
					</label>
				</div>
			</div>
		</aside>

		<!-- Main Results Area -->
		<main class="results-main">
			<div class="results-header">
				<h2>{{ filteredHotels.length }}+ properties</h2>
			</div>

			<div class="hotels-list">
				@for(hotel of filteredHotels; track hotel.id) {
					<div class="hotel-result-card" (click)="viewHotelDetails(hotel)">
						<div class="hotel-image-section">
							<img [src]="hotel.image || 'assets/images/hotel-placeholder.jpg'" [alt]="hotel.name" />
							@if(hotel.isAd) {
								<div class="ad-badge">Ad</div>
							}
							<div class="image-nav">
								<button class="nav-arrow left"><i class="fas fa-chevron-left"></i></button>
								<button class="nav-arrow right"><i class="fas fa-chevron-right"></i></button>
							</div>
							<button class="wishlist-icon" (click)="toggleWishlist(hotel.id, $event)">
								<i class="fas" [class.fa-heart]="hotel.isWishlisted" [class.fa-heart-o]="!hotel.isWishlisted"></i>
							</button>
						</div>

						<div class="hotel-info-section">
							<div class="hotel-header-info">
								<div class="hotel-name-location">
									<h3 class="hotel-name">{{ hotel.name }}</h3>
									<p class="hotel-location">
										<i class="fas fa-map-marker-alt"></i>
										{{ hotel.location }}
									</p>
								</div>
								<div class="hotel-rating">
									<span class="rating-badge" [class.excellent]="hotel.rating >= 8" [class.good]="hotel.rating >= 7 && hotel.rating < 8">
										{{ hotel.rating }}
									</span>
									@if(hotel.rating >= 8) {
										<span class="rating-text">Excellent</span>
									} @else if(hotel.rating >= 7) {
										<span class="rating-text">Good</span>
									}
								</div>
							</div>

							<div class="hotel-features">
								@for(feature of hotel.features.slice(0, 3); track feature) {
									<span class="feature-badge">
										<i class="fas fa-check"></i>
										{{ feature }}
									</span>
								}
							</div>

							<div class="hotel-policies">
								@if(hotel.freeCancellation) {
									<span class="policy-badge green">Fully refundable</span>
								}
								<span class="policy-badge">Reserve now, pay later</span>
							</div>

							<div class="hotel-pricing">
								<div class="price-main">
									<span class="currency">₹</span>
									<span class="amount">{{ hotel.price | number }}</span>
								</div>
								<div class="price-details">
									<span class="price-total">₹{{ hotel.totalPrice | number }} total</span>
									<span class="price-note">includes taxes & fees</span>
								</div>
								@if(hotel.availability) {
									<div class="availability-badge">
										We have {{ hotel.availability }} left at
									</div>
								}
							</div>
						</div>
					</div>
				}
			</div>
		</main>
	</div>

	<!-- Travellers Popup -->
	@if(showTravellersPopup) {
		<div class="travellers-popup-overlay" (click)="closeTravellersPopup()"></div>
		<div class="travellers-popup">
			<div class="popup-header">
				<h3>Room 1</h3>
			</div>
			<div class="popup-content">
				<div class="traveller-option">
					<label>Adults</label>
					<div class="counter">
						<button type="button" (click)="decreaseAdults(); $event.stopPropagation()" [disabled]="searchParams.adults <= 1">-</button>
						<span>{{ searchParams.adults }}</span>
						<button type="button" (click)="increaseAdults(); $event.stopPropagation()">+</button>
					</div>
				</div>
				<div class="traveller-option">
					<label>Children <span class="age-info">Ages 0 to 17</span></label>
					<div class="counter">
						<button type="button" (click)="decreaseChildren(); $event.stopPropagation()" [disabled]="searchParams.children <= 0">-</button>
						<span>{{ searchParams.children }}</span>
						<button type="button" (click)="increaseChildren(); $event.stopPropagation()">+</button>
					</div>
				</div>
				<div class="popup-actions">
					<a href="#" class="link-action" (click)="$event.stopPropagation()">Add another room</a>
					<a href="#" class="link-action" (click)="$event.stopPropagation()">Need to book 9 or more rooms?</a>
				</div>
				<button type="button" class="done-btn" (click)="closeTravellersPopup(); $event.stopPropagation()">Done</button>
			</div>
		</div>
	}
</div>

