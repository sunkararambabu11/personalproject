<div class="checkout-page">
	<app-header></app-header>

	<!-- Promotional Banner -->
	<div class="promo-banner">
		<div class="banner-content">
			<i class="fas fa-gift"></i>
			<span>Sign in or create an account to earn ₹{{ calculateRewards() | number }} in OneKeyCash™ after this trip.</span>
			<i class="fas fa-chevron-right"></i>
		</div>
	</div>

	<div class="checkout-container">
		<!-- Left Column - Forms -->
		<div class="checkout-main">
			<!-- Guest Information -->
			<div class="form-section">
				<h2>Who's checking in?</h2>
				<p class="required-note">* Required</p>
				<div class="room-info">
					<p>Room 1: {{ searchParams.adults }} Adult{{ searchParams.adults > 1 ? 's' : '' }}, Non-smoking</p>
					<div class="inclusions">
						<span class="inclusion-badge">
							<i class="fas fa-check-circle"></i>
							Breakfast included
						</span>
						<span class="inclusion-badge">
							<i class="fas fa-check-circle"></i>
							Free parking
						</span>
					</div>
				</div>

				<form class="guest-form" (ngSubmit)="submitBooking()">
					<div class="form-row">
						<div class="form-group">
							<label>First name *</label>
							<input type="text" class="form-input" [(ngModel)]="guestData.firstName" name="firstName" required placeholder="(e.g. John)" />
						</div>
						<div class="form-group">
							<label>Surname *</label>
							<input type="text" class="form-input" [(ngModel)]="guestData.lastName" name="lastName" required placeholder="(e.g. Smith)" />
						</div>
					</div>

					<div class="form-group">
						<label>Email address *</label>
						<input type="email" class="form-input" [(ngModel)]="guestData.email" name="email" required placeholder="Email for confirmation" />
					</div>

					<div class="form-group checkbox-group">
						<label class="checkbox-label">
							<input type="checkbox" [(ngModel)]="guestData.marketingEmails" name="marketingEmails" />
							<span>Get emails about deals, offers, and other info from us. You can opt out anytime.</span>
						</label>
					</div>

					<div class="form-row">
						<div class="form-group">
							<label>Country/Territory Code *</label>
							<select class="form-input" [(ngModel)]="guestData.countryCode" name="countryCode" required>
								<option value="+91">IND +91</option>
								<option value="+1">USA +1</option>
								<option value="+44">UK +44</option>
							</select>
						</div>
						<div class="form-group">
							<label>Phone number *</label>
							<input type="tel" class="form-input" [(ngModel)]="guestData.phone" name="phone" required placeholder="Enter phone number" />
						</div>
					</div>

					<div class="form-group checkbox-group">
						<label class="checkbox-label">
							<input type="checkbox" [(ngModel)]="guestData.textAlerts" name="textAlerts" />
							<span>Receive text alerts about this trip (free of charge).</span>
						</label>
					</div>
				</form>
			</div>

			<!-- Payment Method -->
			<div class="form-section">
				<h2>Payment method</h2>
				<div class="payment-status">
					<i class="fas fa-check-circle"></i>
					<span>₹0.00 due now. Payment information is only needed to hold your reservation.</span>
				</div>

				<div class="payment-cards">
					<img src="assets/images/mastercard.png" alt="Mastercard" />
					<img src="assets/images/amex.png" alt="American Express" />
					<img src="assets/images/visa.png" alt="Visa" />
					<img src="assets/images/visa-electron.png" alt="Visa Electron" />
				</div>

				<form class="payment-form" (ngSubmit)="submitBooking()">
					<div class="form-group">
						<label>Name on Card *</label>
						<input type="text" class="form-input" [(ngModel)]="paymentData.cardName" name="cardName" required placeholder="Enter name as on card" />
					</div>

					<div class="form-group">
						<label>Debit/Credit card number *</label>
						<input type="text" class="form-input" [(ngModel)]="paymentData.cardNumber" name="cardNumber" required placeholder="0000 0000 0000 0000" maxlength="19" />
						<p class="form-note">Only needed to guarantee your booking</p>
					</div>

					<div class="form-row">
						<div class="form-group">
							<label>Expiry date *</label>
							<div class="date-inputs">
								<select class="form-input" [(ngModel)]="paymentData.expiryMonth" name="expiryMonth" required>
									<option value="">Month</option>
									@for(month of months; track month) {
										<option [value]="month">{{ month }}</option>
									}
								</select>
								<select class="form-input" [(ngModel)]="paymentData.expiryYear" name="expiryYear" required>
									<option value="">Year</option>
									@for(year of years; track year) {
										<option [value]="year">{{ year }}</option>
									}
								</select>
							</div>
						</div>
						<div class="form-group">
							<label>Security code *</label>
							<input type="text" class="form-input" [(ngModel)]="paymentData.securityCode" name="securityCode" required placeholder="CVV" maxlength="4" />
						</div>
					</div>
				</form>
			</div>
		</div>

		<!-- Right Column - Booking Summary -->
		<aside class="booking-summary">
			<div class="summary-hotel">
				<div class="hotel-image">
					<img [src]="hotel?.image || 'assets/images/hotel-placeholder.jpg'" [alt]="hotel?.name" />
					<button class="image-nav left"><i class="fas fa-chevron-left"></i></button>
					<button class="image-nav right"><i class="fas fa-chevron-right"></i></button>
				</div>
				<div class="hotel-info">
					<h3>{{ hotel?.name }}</h3>
					<div class="hotel-rating">
						<span class="rating-badge">{{ hotel?.rating }}</span>
						<span class="rating-text">Very good</span>
						<span class="reviews">({{ hotel?.reviews }} reviews)</span>
					</div>
					<p class="room-type">{{ room?.name }}</p>
					<div class="stay-dates">
						<p><strong>Check-in:</strong> {{ formatDate(searchParams.checkIn) }}</p>
						<p><strong>Check-out:</strong> {{ formatDate(searchParams.checkOut) }}</p>
						<p>{{ calculateNights() }}-night stay</p>
					</div>
					<div class="optional-requests">
						<a href="#" class="request-link">Bedding requests (optional) <i class="fas fa-chevron-right"></i></a>
						<a href="#" class="request-link">Special Requests (optional) <i class="fas fa-chevron-right"></i></a>
					</div>
					<div class="promo-message">
						<i class="fas fa-check-circle"></i>
						<span>You have good taste! Book now before someone else grabs it!</span>
					</div>
				</div>
			</div>

			<div class="price-details">
				<h3>Price details</h3>
				<div class="price-row">
					<span>{{ searchParams.rooms }} room x {{ calculateNights() }} nights</span>
					<span>₹{{ bookingData.price | number }}</span>
				</div>
				<div class="price-row">
					<span>₹{{ bookingData.price | number }} average per night</span>
				</div>
				<div class="price-row">
					<span>Taxes</span>
					<span>₹{{ bookingData.taxes | number }}</span>
				</div>
				<div class="price-row total">
					<span>Total</span>
					<span>₹{{ bookingData.totalPrice | number }}</span>
				</div>
				<div class="payment-breakdown">
					<div class="breakdown-row">
						<span>Pay now</span>
						<span class="green">₹0.00</span>
					</div>
					<div class="breakdown-row">
						<span>Pay at property</span>
						<span>₹{{ bookingData.totalPrice | number }}</span>
					</div>
				</div>
			</div>

			<div class="cancellation-policy">
				<h3>Cancellation policy</h3>
				<ul>
					<li>
						<i class="fas fa-check-circle"></i>
						<span>Fully refundable before {{ formatRefundDate() }}</span>
					</li>
					<li>
						<span>Cancellations or changes made after 14:00 (property local time) on {{ formatRefundDate() }} or no-shows are subject to a property fee equal to the first night's rate plus taxes and fees.</span>
					</li>
				</ul>
			</div>

			<button class="confirm-booking-btn" (click)="submitBooking()">
				<i class="fas fa-credit-card"></i>
				Complete booking
			</button>
		</aside>
	</div>
</div>

